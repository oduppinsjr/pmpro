{"generator":"Code Snippets v2.14.1","date_created":"2021-04-26 01:00","snippets":[{"name":"PMPro Sponsored Members Seats","scope":"global","code":"\/*\nDefine the global array below for your main accounts and sponsored levels.\nArray keys should be the main account level.\n*\/\nglobal $pmprosm_sponsored_account_levels;\n$pmprosm_sponsored_account_levels = array(\n\t1 => array(\n\t\t'main_level_id' => 1, \/\/redundant but useful\n\t\t'sponsored_level_id' => array(1), \/\/array or single id\n\t\t'seat_cost' => 0,\n\t\t'max_seats' => 10,\n\t\t'sponsored_accounts_at_checkout' => true,\n\t\t'apply_seat_cost_to_initial_payment' => true,\n\t\t'apply_seat_cost_to_billing_amount' => true\n\t),\n\t2 => array(\n\t\t'main_level_id' => 1, \/\/redundant but useful\n\t\t'sponsored_level_id' => array(2), \/\/array or single id\n\t\t'seat_cost' => 100,\n\t\t'max_seats' => 10,\n\t\t'sponsored_accounts_at_checkout' => true,\n\t\t'apply_seat_cost_to_initial_payment' => true,\n\t\t'apply_seat_cost_to_billing_amount' => true\n\t),\n\t3 => array(\n\t\t'main_level_id' => 1, \/\/redundant but useful\n\t\t'sponsored_level_id' => array(3), \/\/array or single id\n\t\t'seat_cost' => 100,\n\t\t'max_seats' => 10,\n\t\t'sponsored_accounts_at_checkout' => true,\n\t\t'apply_seat_cost_to_initial_payment' => true,\n\t\t'apply_seat_cost_to_billing_amount' => true\n\t),\n);","priority":"10"},{"name":"PMPro RH Custom Fields","scope":"global","code":"\/**\n * Add custom fields to Paid Memberships Pro checkout page.\n * Must have PMPro & Register Helper Add On installed and activated to work.\n * Add this code to a PMPro Customizations Plugin or Code Snippets plugin.\n *\/\n\nfunction pmpro_add_fields_to_checkout(){\n\t\/\/don't break if Register Helper is not loaded\n\tif(!function_exists( 'pmprorh_add_registration_field' )) {\n\t\treturn false;\n\t}\n\t\n\t$fields = array();\n\t$fields[] = new PMProRH_Field(\n\t\t'insurance_company',\t\t\t\t\t\/\/ input name, will also be used as meta key\n\t\t'text',\t\t\t\t\t\t\/\/ type of field\n\t\tarray(\n\t\t\t'label'\t\t=> 'Insurance Company',\t\t\/\/ custom field label\n\t\t\t'profile'\t=> true,\t\t\/\/ show in user profile\n\t\t\t'required'\t=> true,\t\t\/\/ make this field required\n\t\t\t'showrequired'\t=> true,\t\t\/\/ show this field required\n\t\t\t'memberslistcsv' => true,   \/\/ add to csv export\n\t\t\t'hint'      => 'Enter the name of the insurance company. If none, enter N\/A.',\n\t\t)\n\t\t\t);\n\t\n\t$fields[] = new PMProRH_Field(\n\t\t'insurance_policy_holder',\t\t\t\t\t\/\/ input name, will also be used as meta key\n\t\t'text',\t\t\t\t\t\t\/\/ type of field\n\t\tarray(\n\t\t\t'label'\t\t=> 'Policy Holder',\t\/\/ custom field label\n\t\t\t'profile'\t=> true,\t\t\/\/ show in user profile\n\t\t\t'required'\t=> true,\t\t\/\/ make this field required\n\t\t\t'showrequired'\t=> true,\t\t\/\/ show this field required\n\t\t\t'memberslistcsv' => true,   \/\/ add to csv export\n\t\t\t'hint'      => 'Enter the name of the policy holder. If none, enter N\/A.',\n\t\t)\n\t\t\t);\n\t\n\t\n\t$fields[] = new PMProRH_Field(\n\t\t'insurance_group_number',\t\t\t\t\t\/\/ input name, will also be used as meta key\n\t\t'text',\t\t\t\t\t\t\/\/ type of field\n\t\tarray(\n\t\t\t'label'\t\t=> 'Group #',\t\/\/ custom field label\n\t\t\t'profile'\t=> true,\t\/\/ show in user profile\n\t\t\t'required'\t=> true,\t\/\/ make this field required\n\t\t\t'showrequired'\t=> true,\t\t\/\/ show this field required\n\t\t\t'memberslistcsv' => true,   \/\/ add to csv export\n\t\t\t'hint'      => 'Enter the group #. If none, enter N\/A.',\n\t\t)\n\t\t\t);\n\t\n\t$fields[] = new PMProRH_Field(\n\t\t'insurance_policy_number',\t\t\t\t\t\/\/ input name, will also be used as meta key\n\t\t'text',\t\t\t\t\t\t\/\/ type of field\n\t\tarray(\n\t\t\t'label'\t\t=> 'Policy #',\t\/\/ custom field label\n\t\t\t'profile'\t=> true,\t\/\/ show in user profile\n\t\t\t'required'\t=> true,\t\/\/ make this field required\n\t\t\t'showrequired'\t=> true,\t\t\/\/ show this field required\n\t\t\t'memberslistcsv' => true,   \/\/ add to csv export\n\t\t\t'hint'      => 'Enter the policy #. If none, enter N\/A.',\n\t\t)\n\t\t\t);\n\t\n\t$fields[] = new PMProRH_Field(\n\t\t'insurance_company_phone',\t\t\t\t\t\/\/ input name, will also be used as meta key\n\t\t'text',\t\t\t\t\t\t\/\/ type of field\n\t\tarray(\n\t\t\t'label'\t\t=> 'Insurance Company Phone #',\t\/\/ custom field label\n\t\t\t'profile'\t=> true,\t\/\/ show in user profile\n\t\t\t'required'\t=> true,\t\/\/ make this field required\n\t\t\t'showrequired'\t=> true,\t\t\/\/ show this field required\n\t\t\t'memberslistcsv' => true,   \/\/ add to csv export\n\t\t\t'hint'      => 'Enter the telephone #. If none enter N\/A.',\n\t\t)\n\t\t\t);\n\n\t\/\/add the fields to default forms\n\tforeach($fields as $field){\n\t\tpmprorh_add_registration_field(\n\t\t\t'checkout_boxes', \/\/ location on checkout page\n\t\t\t$field\t\/\/ PMProRH_Field object\n\t\t);\n\t}\n}\nadd_action( 'init', 'pmpro_add_fields_to_checkout' );","priority":"10"},{"name":"PMPro Custom Avatars","scope":"global","code":"\/*\n * Allow members to upload their avatar using a Register Helper field during checkout or on the Member Profile Edit page.\n *\n * Requires: Paid Memberships Pro, Register Helper Add On.\n *\n * You can add this recipe to your site by creating a custom plugin\n * or using the Code Snippets plugin available for free in the WordPress repository.\n * Read this companion article for step-by-step directions on either method.\n * https:\/\/www.paidmembershipspro.com\/create-a-plugin-for-pmpro-customizations\/\n *\/\n\n\/\/ Filter the saved or updated User Avatar meta field value and add the image to the Media Library.\nfunction my_updated_user_avatar_user_meta( $meta_id, $user_id, $meta_key, $meta_value ) {\n\t\/\/ Change user_avatar to your Register Helper file upload name.\n\tif ( 'user_avatar' === $meta_key ) {\n\t\t$user_info\t   = get_userdata( $user_id );\n\t\t$filename      = $meta_value['fullpath'];\n\t\t$filetype      = wp_check_filetype( basename( $filename ), null );\n\t\t$wp_upload_dir = wp_upload_dir();\n\t\t$attachment    = array(\n\t\t\t'post_mime_type' => $filetype['type'],\n\t\t\t'post_title'     => preg_replace( '\/\\.[^.]+$\/', '', basename( $filename ) ),\n\t\t\t'post_status'    => 'inherit',\n\t\t);\n\t\t$attach_id     = wp_insert_attachment( $attachment, $filename );\n\t\t\/\/ Make sure that this file is included, as wp_generate_attachment_metadata() depends on it.\n\t\trequire_once ABSPATH . 'wp-admin\/includes\/image.php';\n\t\t$attach_data = wp_generate_attachment_metadata( $attach_id, $filename );\n\t\twp_update_attachment_metadata( $attach_id, $attach_data );\n\t\tupdate_user_meta( $user_id, 'wp_user_avatar', $attach_id );\n\t}\n}\nadd_action( 'added_user_meta', 'my_updated_user_avatar_user_meta', 10, 4 );\nadd_action( 'updated_user_meta', 'my_updated_user_avatar_user_meta', 10, 4 );\n\n\/\/ Filter the display of the the get_avatar function to use our local avatar.\nfunction my_user_avatar_filter( $avatar, $id_or_email, $size, $default, $alt ) {\n\t$my_user = get_userdata( $id_or_email );\n\tif ( ! empty( $my_user ) ) {\n\t\t$avatar_id = get_user_meta( $my_user->ID, 'wp_user_avatar', true );\n\t\tif ( ! empty( $avatar_id ) ) {\n\t\t\t$avatar = wp_get_attachment_url( $avatar_id, $size );\n\t\t\t$avatar = \"<img alt='{$alt}' src='{$avatar}' class='avatar avatar-{$size} photo' height='{$size}' width='{$size}' \/>\";\n\t\t}\n\t}\n\treturn $avatar;\n}\nadd_filter( 'get_avatar', 'my_user_avatar_filter', 20, 5 );\n\n\/\/ Add the User Avatar field at checkout and on the profile edit forms.\nfunction my_pmprorh_init_user_avatar() {\n\t\/\/don't break if Register Helper is not loaded\n\tif ( ! function_exists( 'pmprorh_add_registration_field' ) ) {\n\t\treturn false;\n\t}\n\t\/\/define the fields\n\t$fields   = array();\n\t$fields[] = new PMProRH_Field(\n\t\t'user_avatar',              \/\/ input name, will also be used as meta key\n\t\t'file',                 \/\/ type of field\n\t\tarray(\n\t\t\t'label'     => 'Avatar',\n\t\t\t'hint'      => 'Recommended size is 100px X 100px',\n\t\t\t'profile'   => true,    \/\/ show in user profile\n\t\t\t'preview'   => true,    \/\/ show a preview-sized version of the image\n\t\t\t'addmember' => true,\n\t\t\t'allow_delete' => true,\n\t\t)\n\t);\n\n\t\/\/add the fields into a new checkout_boxes are of the checkout page\n\t\/\/foreach ( $fields as $field ) {\n\t\/\/\tpmprorh_add_registration_field(\n\t\/\/\t\t'checkout_boxes', \/\/ location on checkout page\n\t\/\/\t\t$field            \/\/ PMProRH_Field object\n\t\/\/\t);\n\t\/\/}\n}\nadd_action( 'init', 'my_pmprorh_init_user_avatar' );","priority":"10"},{"name":"PMPro Sponsored Members List in Parent Profile","scope":"global","code":"\/**\n * This recipe lists an account's sponsored members on the Membership Account page.\n * \n * It is intended for use with the Sponsord Members Add On:\n * https:\/\/www.paidmembershipspro.com\/add-ons\/pmpro-sponsored-members\/\n * \n * You can add this recipe to your site by creating a custom plugin\n * or using the Code Snippets plugin available for free in the WordPress repository.\n * Read this companion article for step-by-step directions on either method.\n * https:\/\/www.paidmembershipspro.com\/create-a-plugin-for-pmpro-customizations\/\n *\/\n\nfunction mypmpro_member_action_links_after() {\n\tglobal $current_user;\n\n\t$user_ids = pmprosm_getChildren( $current_user->ID );\n\n\tif ( ! empty( $user_ids ) ) {\n\t\t?>\n\t\t<br\/><br\/>\n\t\t<h3>Sponsored Members<\/h3>\n\t\t<table class=\"pmpro_table\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>Name<\/th>\n\t\t\t\t\t\t<th>Email<\/th>\n\t\t\t\t\t<\/tr>\n\t\t\t\t<\/thead>\n\t\t\t\t<tbody>\n\t\t\t\t<?php\n\n\t\t\t\t$user_list = new WP_User_Query( array(\n\t\t\t\t\t'include' => $user_ids,\n\t\t\t\t\t'orderby' => 'name',\n\t\t\t\t\t'order'   => 'ASC'\n\t\t\t\t) );\n\t\t\t\t$sponsored_members = $user_list->get_results();\n\t\t\t\tif ( ! empty( $sponsored_members ) ) {\n\t\t\t\t\tforeach( $sponsored_members as $sponsored_member ) {\n\t\t\t\t\t\techo \t'<tr><td>' . esc_html($sponsored_member->data->display_name ) .\n\t\t\t\t\t\t\t\t \t'<\/td><td> ' . esc_html( $sponsored_member->data->user_email ) .\n\t\t\t\t\t\t\t\t\t' <\/td><\/tr>';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t?>\n\t\t\t\t<\/tbody>\n\t\t\t<\/table>\n\t\t<?php\t\t\n\t}\n}\nadd_action( 'pmpro_member_action_links_after', 'mypmpro_member_action_links_after' );","priority":"10"},{"name":"PMPro Sponsored Members Add Additional Fields to Child Accounts","scope":"global","code":"\/*\n\tCode demo on using pmprosm_children_fields() and pmprosm_after_child_created() hooks to add additional fields to checkout child account creation.\n\tAdds shipping fields to child accounts at checkout. Use PMPro Shipping Address on Membership Checkout to view\n*\/\n\nfunction pmprosm_additional_child_fields($i, $seats)\n{?><br><label>First Name<\/label><input type=\"text\" name=\"add_sub_accounts_first_name\" value=\"\" size=\"20\" \/><br><label>Last Name<\/label><input type=\"text\" name=\"add_sub_accounts_last_name\" value=\"\" size=\"20\" \/><br><label>Birth Date<\/label><input type=\"date\" name=\"add_child_birth_date\" value=\"\" size=\"20\" \/><br><label>Shirt Size<\/label><select name=\"add_child_shirt_size\" style=\"width:100%!important;\" value=\"\" size=\"20\"><option value=\"Youth S\">Youth S<\/option><option value=\"Youth M\">Youth M<\/option><option value=\"Youth L\">Youth L<\/option><option value=\"Youth XL\">Youth XL<\/option><option value=\"Adult XS\">Adult XS<\/option><option value=\"Adult S\">Adult S<\/option><option value=\"Adult M\">Adult M<\/option><option value=\"Adult L\">Adult L<\/option><option value=\"Adult XL\">Adult XL<\/option><\/select><br><br><label>AAU Membership #<\/label><input type=\"text\" name=\"add_aau_membership\" value=\"\" size=\"20\" \/><br><label>Physical Limitations (if none state N\/A)<\/label><input type=\"text\" name=\"add_child_physical_limitations\" value=\"\" size=\"20\" \/><br><label>Allergies (if none state N\/A)<\/label><input type=\"text\" name=\"add_child_allergies\" value=\"\" size=\"20\" \/><?php\n}\n\nadd_action('pmprosm_children_fields', 'pmprosm_additional_child_fields', 10, 2);\n\nfunction pmprosm_save_additional_child_fields($child_user_id, $user_id, $i)\n{\n\t\n\tif(!empty($_REQUEST['add_sub_accounts_first_name']))\n\t\t$child_first_name =\t$_REQUEST['add_sub_accounts_first_name'];\n\telse\n\t\t$child_first_name =\t'';\n\t\n\tif(!empty($_REQUEST['add_sub_accounts_last_name']))\n\t\t$child_last_name =\t$_REQUEST['add_sub_accounts_last_name'];\n\telse\n\t\t$child_last_name =\t'';\n\t\n\tif(!empty($_REQUEST['add_child_birth_date']))\n\t\t$child_birth_date =\t$_REQUEST['add_child_birth_date'];\n\telse \n\t\t$child_birth_date = '';\n\t\n\tif(!empty($_REQUEST['add_child_shirt_size']))\n\t\t$child_shirt_size =\t$_REQUEST['add_child_shirt_size'];\n\telse \n\t\t$child_shirt_size = '';\n\t\n\tif(!empty($_REQUEST['add_child_aau_membership']))\n\t\t$child_aau_membership =\t$_REQUEST['add_child_aau_membership'];\n\telse \n\t\t$child_aau_membership = '';\n\t\n\tif(!empty($_REQUEST['add_child_physical_limitations']))\n\t\t$child_physical_limitations =\t$_REQUEST['add_child_physical_limitations'];\n\telse\n\t\t$child_physical_limitations = '';\n\t\n\tif(!empty($_REQUEST['add_child_allergies']))\n\t\t$child_allergies \t=\t$_REQUEST['add_child_allergies'];\n\telse\n\t\t$child_allergies   = '';\n\t\n\tif(!empty($child_first_name))\n\t{\n\t\tupdate_user_meta($child_user_id, \"pmpro_sfirstname\", $child_first_name[$i]);\n\t\tupdate_user_meta($child_user_id, \"pmpro_slastname\", $child_last_name[$i]);\n\t\tupdate_user_meta($child_user_id, \"pmpro_sbirthdate\", $child_birth_date[$i]);\n\t\tupdate_user_meta($child_user_id, \"pmpro_sshirtsize\", $child_shirt_size[$i]);\n\t\tupdate_user_meta($child_user_id, \"pmpro_saaumembership\", $child_aau_membership[$i]);\n\t\tupdate_user_meta($child_user_id, \"pmpro_sphysicallimitations\", $child_physical_limitations[$i]);\n\t\tupdate_user_meta($child_user_id, \"pmpro_sallergies\", $child_allergies[$i]);\n\t}\t\n}\n\nadd_action('pmprosm_after_child_created', 'pmprosm_save_additional_child_fields', 10, 3);","priority":"10"},{"name":"PMPro Order Renewals","scope":"global","code":"\/*\n * Adds a \"Renewal\" column to the Orders list and order CSV export\n * to show if the order is a membership renewal.\n *\/\nfunction my_pmpro_is_order_renewal( $order ) {\n\tglobal $wpdb;\n\n\t\/\/check for earlier orders with the same user_id and membership_id\n\t$sqlQuery = \"SELECT id FROM $wpdb->pmpro_membership_orders WHERE \n\t\t\tuser_id = '\" . esc_sql($order->user_id) . \"' AND \n\t\t\tmembership_id = '\" . esc_sql($order->membership_id) . \"' AND \n\t\t\tid <> '\" . esc_sql($order->id) . \"' AND\n\t\t\ttimestamp < '\" . date(\"Y-m-d H:i:s\", $order->timestamp) . \"' \n\t\t\tLIMIT 1\";\n\n\t$earlier_order = $wpdb->get_var($sqlQuery);\t\t\t\t\n\tif(empty($earlier_order))\n\t\treturn false;\n\n\t\/\/must be recurring\n\treturn true;\n}\n\n\/*\n *\tadd recurring column to orders table\n *\/\n\/\/table header\nfunction my_pmpro_orders_extra_cols_renewal_header()\n{\n?>\n<th>Renewal?<\/th>\n<?php\n}\nadd_action('pmpro_orders_extra_cols_header', 'my_pmpro_orders_extra_cols_renewal_header');\n\n\/\/table body\nfunction my_pmpro_orders_extra_cols_renewal_body($order)\n{\n\t?>\n\t<td>\n\t<?php\n\tif( my_pmpro_is_order_renewal( $order ) )\n\t\techo \"Yes\";\n\telse\n\t\techo \"No\";\n\t?>\n\t<\/td>\n\t<?php\n}\nadd_action('pmpro_orders_extra_cols_body', 'my_pmpro_orders_extra_cols_renewal_body');\n\n\/*\n\tadd recurring column to orders export\n*\/\nfunction my_pmpro_orders_csv_extra_columns_renewal($columns)\n{\n\t$columns['renewal'] = 'my_pmpro_orders_csv_recurring_column_renewal';\n\treturn $columns;\n}\nadd_filter('pmpro_orders_csv_extra_columns', 'my_pmpro_orders_csv_extra_columns_renewal');\n\nfunction my_pmpro_orders_csv_recurring_column_renewal($order)\n{\n\tif(my_pmpro_is_order_renewal($order))\n\t\treturn \"Yes\";\n\telse\n\t\treturn \"No\";\n}","priority":"10"},{"name":"PMPro Lock First & Last Names","scope":"global","code":"\/**\n * This recipe assigns the readonly attribute to the fields\n * first_name and last_name on the PMPro profile edit page\n * on the front-end and the user profile page in the\n * WordPress dashboard (back-end)\n *\n * You can add this recipe to your site by creating a custom plugin\n * or using the Code Snippets plugin available for free in the WordPress repository.\n * Read this companion article for step-by-step directions on either method.\n * https:\/\/www.paidmembershipspro.com\/create-a-plugin-for-pmpro-customizations\/\n *\/\n\nfunction read_only_first_and_last_names_javascript() {\n\n\t\/\/ Bail if admin or not logged in user.\n\tif ( ! is_user_logged_in() || current_user_can( 'manage_options' ) ) {\n\t\treturn;\n\t}\n\n\tglobal $current_user;\n\t\/\/ Bail if first and last name values empty\n\tif ( empty( get_user_meta( $current_user->ID, 'first_name' ) ) && empty( get_user_meta( $current_user->ID, 'last_name' ) ) ) {\n\t\treturn;\n\t}\n\t?>\n<script>jQuery(document).ready(function ($) {\n\t$('#first_name').attr('readonly', true);\n\t$('#last_name').attr('readonly', true);\n});\t<\/script>\n\t<?php\n}\n\nfunction read_only_first_and_last_names_init() {\n\t\/\/ We're on the WP Dashboard but not an admin.\n\tglobal $pagenow;\n\tif ( is_admin() && 'profile.php' === $pagenow ) {\n\t\tadd_action( 'admin_footer', 'read_only_first_and_last_names_javascript' );\n\t}\n}\nadd_action( 'init', 'read_only_first_and_last_names_init' );\n\nfunction read_only_first_and_last_names_wp() {\n\t\/\/ Bail if PMPro Core not active\n\tif ( ! defined( 'PMPRO_VERSION' ) ) {\n\t\treturn false;\n\t}\n\t\/\/ We're on the front end profile edit page.\n\tglobal $pmpro_pages;\n\tif ( is_page( $pmpro_pages['member_profile_edit'] ) ) {\n\t\tadd_action( 'wp_footer', 'read_only_first_and_last_names_javascript' );\n\t}\n}\nadd_action( 'wp', 'read_only_first_and_last_names_wp' );","priority":"10"},{"name":"PMPro Show Member Badge on Registration Page","scope":"global","code":"\/*\n  Sample method to show a level's Member Badge on the three column layout of the \n  Membership Levels page when using the Advanced Levels Page Shortcode Add On.\n*\/\nfunction my_pmproal_before_level_member_badge( $level_id, $layout ) {\n\tif( function_exists( 'pmpromb_getBadgeForLevel' ) ) {\n\t\t$image = pmpromb_getBadgeForLevel($level_id);\n\t\tif( ! empty( $image ) && $layout == '3col' ) {\n\t\t\techo '<img class=\"pmpro_member_badge\" src=\"' . esc_url($image) . '\" border=\"0\" \/>';\n\t\t}\n\t}\n}\nadd_action( 'pmproal_before_level', 'my_pmproal_before_level_member_badge', 10, 2);","priority":"10"},{"name":"PMPro Carbon Copy Admin Emails","scope":"global","code":"\/*Add CC for PMPro admin emails\n*\/\n\nfunction my_pmpro_email_headers_admin_emails($headers, $email) {\t\t\n\t\/\/cc emails already going to admin_email\n        if(strpos($email->template, '_admin') !== false)\n\t{\n\t\t\/\/add cc\n\t\t$headers[] = 'cc:' . 'oduppinsjr@outlook.com'; \/\/ type in your email address here please.\n\t\t\/\/ if you want to cc only one email:, replace line 12 with: $headers[] = 'cc:' . 'otheremail@domain.com';\n\t}\n \n\treturn $headers;\n}\n\nadd_filter('pmpro_email_headers', 'my_pmpro_email_headers_admin_emails', 10, 2);","priority":"10"},{"name":"PMPro Blind Copy Admin Emails","scope":"global","code":"\n\/*\nAdd bcc for checkout emails\n*\/\nfunction my_pmpro_email_headers_admin_emails($headers, $email) {\t\t\n\t\/\/bcc checkout emails\n\tif(strpos($email->template, \"checkout_\") !== false) {\n\t\t\/\/add bcc\n\t\t$headers[] = \"Bcc:\" . \"otheremail@domain.com\";\t\t\n\t}\n \n\treturn $headers;\n}\nadd_filter(\"pmpro_email_headers\", \"my_pmpro_email_headers_admin_emails\", 10, 2);","priority":"10"},{"name":"PMPro Account Customizations ","scope":"global","code":"\/\/function pmpro_shortcode_account($atts, $content = null, $code = \"\") {\n\t\/\/ overwite the account shortcode\nfunction overwite_pmpro_shortcode_account($atts, $content=null, $code=\"\")\n{\n    global $wpdb, $pmpro_msg, $pmpro_msgt, $pmpro_levels, $current_user, $levels;\n    \/\/ $atts    ::= array of attributes\n    \/\/ $content ::= text within enclosing form of shortcode element\n    \/\/ $code    ::= the shortcode found, when == callback name\n    \/\/ examples: [pmpro_account] [pmpro_account sections=\"membership,profile\"\/]\n    extract(shortcode_atts(array('section' => '', 'sections' => 'membership,profile,invoices,links'), $atts));\n    \/\/did they use 'section' instead of 'sections'?\n    if (!empty($section)) {\n        $sections = $section;\n    }\n    \/\/turn into an array\n    $sections = explode(',', $sections);\n    ob_start();\n    \/\/if a member is logged in, show them some info here (1. past invoices. 2. billing information with button to update.)\n    if (pmpro_hasMembershipLevel()) {\n        $ssorder = new MemberOrder();\n        $ssorder->getLastMemberOrder();\n        $invoices = $wpdb->get_results(\"SELECT *, UNIX_TIMESTAMP(timestamp) as timestamp FROM {$wpdb->pmpro_membership_orders} WHERE user_id = '{$current_user->ID}' ORDER BY timestamp DESC LIMIT 6\");\n        ?>\n\t\n\t<div id=\"pmpro_account\">\t\t\n\t\t\n\t\t<?php \n        if (in_array('membership', $sections) || in_array('memberships', $sections)) {\n            ?>\n\t\t\t<div id=\"pmpro_account-membership\" class=\"pmpro_box\">\n\t\t\t\t\n\t\t\t\t<h3><?php \n            _e(\"My Memberships\", \"pmpro\");\n            ?>\n<\/h3>\n\t\t\t\t<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n\t\t\t\t\t<thead>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<th><?php \n            _e(\"Level\", \"pmpro\");\n            ?>\n<\/th>\n\t\t\t\t\t\t\t<th><?php \n            _e(\"Billing\", \"pmpro\");\n            ?>\n<\/th>\n\t\t\t\t\t\t\t<th><?php \n            _e(\"Expiration\", \"pmpro\");\n            ?>\n<\/th>\n\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t<\/thead>\n\t\t\t\t\t<tbody>\n\t\t\t\t\t\t<?php \n            \/\/TODO: v2.0 will loop through levels here\n            $level = $current_user->membership_level;\n            ?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"pmpro_account-membership-levelname\">\n\t\t\t\t\t\t\t\t<?php \n            echo $current_user->membership_level->name;\n            ?>\n\t\t\t\t\t\t\t\t<div class=\"pmpro_actionlinks\">\n\t\t\t\t\t\t\t\t\t<?php \n            do_action(\"pmpro_member_action_links_before\");\n            ?>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<?php \n            if (pmpro_isLevelExpiringSoon($current_user->membership_level)) {\n                ?>\n\t\t\t\t\t\t\t\t\t\t<a href=\"<?php \n                echo pmpro_url(\"checkout\", \"?level=\" . $current_user->membership_level->id, \"https\");\n                ?>\n\"><?php \n                _e(\"Renew\", \"pmpro\");\n                ?>\n<\/a>\n\t\t\t\t\t\t\t\t\t<?php \n            }\n            ?>\n\n\t\t\t\t\t\t\t\t\t<?php \n            if (isset($ssorder->status) && $ssorder->status == \"success\" && (isset($ssorder->gateway) && in_array($ssorder->gateway, array(\"authorizenet\", \"paypal\", \"stripe\", \"braintree\", \"payflow\", \"cybersource\")))) {\n                ?>\n\t\t\t\t\t\t\t\t\t\t<a href=\"<?php \n                echo pmpro_url(\"billing\", \"\", \"https\");\n                ?>\n\"><?php \n                _e(\"Update Billing Info\", \"pmpro\");\n                ?>\n<\/a>\n\t\t\t\t\t\t\t\t\t<?php \n            }\n            ?>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<?php \n            \/\/To do: Only show CHANGE link if this level is in a group that has upgrade\/downgrade rules\n            if (count($pmpro_levels) > 1 && !defined(\"PMPRO_DEFAULT_LEVEL\")) {\n                ?>\n\t\t\t\t\t\t\t\t\t\t<a href=\"<?php \n                echo pmpro_url(\"levels\");\n                ?>\n\"><?php \n                _e(\"Change\", \"pmpro\");\n                ?>\n<\/a>\n\t\t\t\t\t\t\t\t\t<?php \n            }\n            ?>\n\t\t\t\t\t\t\t\t\t<a href=\"<?php \n            echo pmpro_url(\"cancel\", \"?level=\" . $current_user->membership_level->id);\n            ?>\n\"><?php \n            _e(\"Cancel\", \"pmpro\");\n            ?>\n<\/a>\n\t\t\t\t\t\t\t\t\t<?php \n            do_action(\"pmpro_member_action_links_after\");\n            ?>\n\t\t\t\t\t\t\t\t<\/div> <!-- end pmpro_actionlinks -->\n\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t<td class=\"pmpro_account-membership-levelfee\">\n\t\t\t\t\t\t\t\t<p><?php \n            echo pmpro_getLevelCost($level, true, true);\n            ?>\n<\/p>\n\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t\t<td class=\"pmpro_account-membership-expiration\">\n\t\t\t\t\t\t\t<?php \n            if ($current_user->membership_level->enddate) {\n                echo date(get_option('date_format'), $current_user->membership_level->enddate);\n            } else {\n                echo \"---\";\n            }\n            ?>\n\t\t\t\t\t\t\t<\/td>\n\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t<\/tbody>\n\t\t\t\t<\/table>\n\t\t\t\t<?php \n            \/\/Todo: If there are multiple levels defined that aren't all in the same group defined as upgrades\/downgrades\n            ?>\n\t\t\t\t<div class=\"pmpro_actionlinks\">\n\t\t\t\t\t<a href=\"<?php \n            echo pmpro_url(\"levels\");\n            ?>\n\"><?php \n            _e(\"View all Membership Options\", \"pmpro\");\n            ?>\n<\/a>\n\t\t\t\t<\/div>\n\n\t\t\t<\/div> <!-- end pmpro_account-membership -->\n\t\t<?php \n        }\n        ?>\n\t\t\n\t\t<?php \n        if (in_array('profile', $sections)) {\n            ?>\n\t\t\t<div id=\"pmpro_account-profile\" class=\"pmpro_box\">\t\n\t\t\t\t<?php \n            get_currentuserinfo();\n            ?>\n \n\t\t\t\t<h3><?php \n            _e(\"My Account\", \"pmpro\");\n            ?>\n<\/h3>\n\t\t\t\t<?php \n            if ($current_user->user_firstname) {\n                ?>\n\t\t\t\t\t<p><?php \n                echo $current_user->user_firstname;\n                ?>\n <?php \n                echo $current_user->user_lastname;\n                ?>\n<\/p>\n\t\t\t\t<?php \n            }\n            ?>\n\t\t\t\t<ul>\n\t\t\t\t\t<?php \n            do_action('pmpro_account_bullets_top');\n            ?>\n\t\t\t\t\t<li><strong><?php \n            _e(\"Username\", \"pmpro\");\n            ?>\n:<\/strong> <?php \n            echo $current_user->user_login;\n            ?>\n<\/li>\n\t\t\t\t\t<li><strong><?php \n            _e(\"Email\", \"pmpro\");\n            ?>\n:<\/strong> <?php \n            echo $current_user->user_email;\n            ?>\n<\/li>\n\t\t\t\t\t<?php \n            do_action('pmpro_account_bullets_bottom');\n            ?>\n\t\t\t\t<\/ul>\n\t\t\t\t<div class=\"pmpro_actionlinks\">\n\t\t\t\t\t<a href=\"<?php \n            echo admin_url('profile.php');\n            ?>\n\"><?php \n            _e(\"Edit Profile\", \"pmpro\");\n            ?>\n<\/a>\n\t\t\t\t\t<a href=\"<?php \n            echo admin_url('profile.php');\n            ?>\n\"><?php \n            _e('Change Password', 'pmpro');\n            ?>\n<\/a>\n\t\t\t\t<\/div>\n\t\t\t<\/div> <!-- end pmpro_account-profile -->\n\t\t<?php \n        }\n        ?>\n\t\n\t\t<?php \n        if (in_array('invoices', $sections) && !empty($invoices)) {\n            ?>\n\t\t\n\t\t<div id=\"pmpro_account-invoices\" class=\"pmpro_box\">\n\t\t\t<h3><?php \n            _e(\"Past Invoices\", \"pmpro\");\n            ?>\n<\/h3>\n\t\t\t<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th><?php \n            _e(\"Date\", \"pmpro\");\n            ?>\n<\/th>\n\t\t\t\t\t\t<th><?php \n            _e(\"Level\", \"pmpro\");\n            ?>\n<\/th>\n\t\t\t\t\t\t<th><?php \n            _e(\"Amount\", \"pmpro\");\n            ?>\n<\/th>\n\t\t\t\t\t<\/tr>\n\t\t\t\t<\/thead>\n\t\t\t\t<tbody>\n\t\t\t\t<?php \n            $count = 0;\n            foreach ($invoices as $invoice) {\n                if ($count++ > 4) {\n                    break;\n                }\n                \/\/get an member order object\n                $invoice_id = $invoice->id;\n                $invoice = new MemberOrder();\n                $invoice->getMemberOrderByID($invoice_id);\n                $invoice->getMembershipLevel();\n                ?>\n\t\t\t\t\t\t<tr id=\"pmpro_account-invoice-<?php \n                echo $invoice->code;\n                ?>\n\">\n\t\t\t\t\t\t\t<td><a href=\"<?php \n                echo pmpro_url(\"invoice\", \"?invoice=\" . $invoice->code);\n                ?>\n\"><?php \n                echo date(get_option(\"date_format\"), $invoice->timestamp);\n                ?>\n<\/td>\n\t\t\t\t\t\t\t<td><?php \n                echo $invoice->membership_level->name;\n                ?>\n<\/td>\n\t\t\t\t\t\t\t<td><?php \n                echo pmpro_formatPrice($invoice->total);\n                ?>\n<\/td>\n\t\t\t\t\t\t<\/tr>\n\t\t\t\t\t\t<?php \n            }\n            ?>\n\t\t\t\t<\/tbody>\n\t\t\t<\/table>\t\t\t\t\t\t\n\t\t\t<?php \n            if ($count == 6) {\n                ?>\n\t\t\t\t<div class=\"pmpro_actionlinks\"><a href=\"<?php \n                echo pmpro_url(\"invoice\");\n                ?>\n\"><?php \n                _e(\"View All Invoices\", \"pmpro\");\n                ?>\n<\/a><\/div>\n\t\t\t<?php \n            }\n            ?>\n\t\t<\/div> <!-- end pmpro_account-invoices -->\n\t\t<?php \n        }\n        ?>\n\t\t\n\t\t<?php \n        if (in_array('links', $sections) && (has_filter('pmpro_member_links_top') || has_filter('pmpro_member_links_bottom'))) {\n            ?>\n\t\t<div id=\"pmpro_account-links\" class=\"pmpro_box\">\n\t\t\t<h3><?php \n            _e(\"Member Links\", \"pmpro\");\n            ?>\n<\/h3>\n\t\t\t<ul>\n\t\t\t\t<?php \n            do_action(\"pmpro_member_links_top\");\n            ?>\n\t\t\t\t\n\t\t\t\t<?php \n            do_action(\"pmpro_member_links_bottom\");\n            ?>\n\t\t\t<\/ul>\n\t\t<\/div> <!-- end pmpro_account-links -->\t\t\n\t\t<?php \n        }\n        ?>\n\t<\/div> <!-- end pmpro_account -->\t\t\n\t<?php \n    }\n    $content = ob_get_contents();\n    ob_end_clean();\n    return $content;\n}","priority":"10"},{"name":"PMPro Change Membership to Clinic","scope":"global","code":"\/\/ Change 'Membership' to 'Clinic' for Paid Memberships Pro.\nfunction my_gettext_membership( $translated_text, $text, $domain ) {\n\tif( \"paid-memberships-pro\" == $domain ) {\n\t\t$translated_text = str_replace( \"Membership Level\", \"Clinic\", $translated_text );\n\t\t$translated_text = str_replace( \"membership level\", \"clinic\", $translated_text );\n\t\t$translated_text = str_replace( \"for membership\", \"for this clinic\", $translated_text );\n\t\t$translated_text = str_replace( \"membership\", \"clinic\", $translated_text );\n\t\t$translated_text = str_replace( \"Membership\", \"Clinic\", $translated_text );\n\t}\n\treturn $translated_text;\n}\nadd_filter( \"gettext\", \"my_gettext_membership\", 10, 3 );","priority":"10"},{"name":"PMPro Member ID on Account Page","scope":"global","code":"\n\/**\n * This shows the WordPress User ID as a Member ID on the Paid Memberships Pro Account Page.\n * Add the code below to your PMPro Customizations Plugin - https:\/\/www.paidmembershipspro.com\/create-a-plugin-for-pmpro-customizations\/\n * www.paidmembershipspro.com\n *\/\n\nfunction pmpro_add_user_id_account() {\n\tglobal $current_user;\n\n\techo '<li><strong>Member ID: <\/strong>' . $current_user->ID . '<\/li>';\n}\nadd_action( 'pmpro_account_bullets_top', 'pmpro_add_user_id_account' );","priority":"10"},{"name":"PMPro Auto Child Generate Username & Passwords","scope":"global","code":"\n\/**\n * This will generate information for username, password and password 2. This is great for free levels.\n * Adjust the $generate_data_level ID's to allow data generation for specific levels.\n * Use CSS to hide these fields on the checkout page from the frontend.\n * Add this code to your PMPro Customizations Plugin - https:\/\/www.paidmembershipspro.com\/create-a-plugin-for-pmpro-customizations\/\n *\/\n\n\/\/ Function to make fields optional for free levels.\nfunction my_generate_fields_for_users() {\n\n\tif ( !isset( $_REQUEST['level'] ) ) {\n\t\treturn;\n\t}\n\n\t$generate_data_levels = array( '1', '2', '5' ); \/\/ Level ID's to generate data for.\n\n\tif ( ! in_array( $_REQUEST['level'], $generate_data_levels ) ) {\n\t\treturn;\n\t}\n\n\t\/\/ Generate Email Address as username.\n\tif(!empty($_REQUEST['bemail'])) {\n    \t\t$_REQUEST['username'] = $_REQUEST['bemail'];\n    \t}\n    \n  \tif(!empty($_POST['bemail'])) {\n    \t\t$_POST['username'] = $_POST['bemail'];\n\t}\n    \n  \tif(!empty($_GET['bemail'])) {\n   \t\t $_GET['username'] = $_GET['bemail'];\n\t}\n\t\n\t\/\/ Generate passwords.\n\tif( ! empty( $_REQUEST['username'] ) && empty( $_REQUEST['password'] ) ) {\n\t\t$_REQUEST['password'] = wp_generate_password( 12, true, false );\t\/\/ Generate Password.\n\t\t$_REQUEST['password2'] = $_REQUEST['password'];\n\t}\n}\nadd_action( 'init', 'my_generate_fields_for_users' );","priority":"10"}]}